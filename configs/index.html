<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>configs</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* --- RESET & BASE --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { background-color: #030303; color: #ffffff; font-family: 'Inter', sans-serif; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        #particles-js { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        .wrapper { display: flex; width: 1000px; height: 650px; gap: 50px; padding: 20px; }

        /* --- SIDEBAR --- */
        .sidebar { width: 240px; display: flex; flex-direction: column; gap: 25px; padding-top: 20px; }
        .profile-card { display: flex; align-items: center; gap: 15px; padding-bottom: 20px; border-bottom: 1px solid #1a1a1a; }
        .static-avatar { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #222; object-fit: cover; flex-shrink: 0; }
        .identity { display: flex; flex-direction: column; justify-content: center; overflow: hidden; }
        .identity h1 { font-size: 18px; font-weight: 800; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .identity p { font-size: 13px; color: #666; font-weight: 500; margin-top: 4px; }
        .nav { display: flex; flex-direction: column; gap: 8px; }
        .nav-btn { display: flex; align-items: center; gap: 12px; padding: 12px 15px; border-radius: 10px; color: #777; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; text-decoration: none; user-select: none; }
        .nav-btn:hover { background: rgba(255,255,255,0.05); color: #fff; }
        .nav-btn.active { background: #111; color: #fff; border: 1px solid #222; }
        .nav-btn i { width: 20px; text-align: center; }

        /* CONTENT */
        .main-content { flex-grow: 1; display: flex; flex-direction: column; gap: 20px; overflow-y: auto; padding-right: 10px; }
        .main-content::-webkit-scrollbar { display: none; }

        /* MOD CARD STYLES */
        .mod-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
        
        .mod-card { 
            background: #0a0a0a; border: 1px solid #222; border-radius: 12px; overflow: hidden; 
            display: flex; height: 140px; transition: 0.2s; 
        }
        .mod-card:hover { border-color: #444; transform: translateX(5px); }
        
        /* Media Container */
        .mod-media { 
            width: 200px; height: 100%; background: #000; border-right: 1px solid #222; 
            position: relative; flex-shrink: 0; cursor: zoom-in; overflow: hidden;
        }
        .mod-img, .mod-video { width: 100%; height: 100%; object-fit: cover; transition: 0.3s; }
        
        /* Hover Effect for Media */
        .mod-media:hover .mod-img, .mod-media:hover .mod-video { opacity: 0.8; transform: scale(1.05); }

        .mod-content { padding: 20px; display: flex; flex-direction: column; justify-content: center; width: 100%; }
        .mod-type { font-size: 10px; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .mod-title { font-size: 18px; font-weight: 700; color: #fff; margin-bottom: 4px; }
        .mod-date { font-size: 11px; color: #555; }
        
        .mod-actions { margin-left: auto; margin-right: 20px; align-self: center; display: flex; gap: 10px; }
        
        .mod-dl-btn { 
            background: #fff; color: #000; padding: 10px 20px; border-radius: 8px; 
            text-decoration: none; font-size: 13px; font-weight: 700; transition: 0.2s; display: flex; align-items: center; gap: 8px;
        }
        .mod-dl-btn:hover { background: #ccc; }

        /* --- LIGHTBOX (MODAL) --- */
        #lightbox {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            z-index: 9999;
            display: none; /* Hidden by default */
            justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.3s ease;
        }
        #lightbox.active { display: flex; opacity: 1; }
        
        /* The expanded media */
        #lightbox-media {
            max-width: 80%; max-height: 80%;
            border-radius: 12px;
            box-shadow: 0 0 50px rgba(255,255,255,0.1);
            border: 1px solid #333;
            object-fit: contain;
        }

        /* Close Button */
        .close-lightbox {
            position: absolute; top: 30px; right: 30px;
            color: #fff; font-size: 30px; cursor: pointer;
            z-index: 10000; transition: 0.2s;
        }
        .close-lightbox:hover { color: #ccc; transform: scale(1.1); }

    </style>
</head>
<body>
    <div id="particles-js"></div>
    
    <div id="lightbox" onclick="closeLightbox()">
        <i class="fa-solid fa-xmark close-lightbox"></i>
        <div id="lightbox-content">
            </div>
    </div>

    <div class="wrapper">
        <aside class="sidebar">
            <div class="profile-card">
                <img id="sidebar-avatar" src="https://via.placeholder.com/150" class="static-avatar">
                <div class="identity">
                    <h1 id="sidebar-displayname">Loading...</h1>
                    <p id="sidebar-username">@...</p>
                </div>
            </div>
            <nav class="nav">
                <a href="../index.html" class="nav-btn"><i class="fa-solid fa-house"></i> Home</a>
                <a href="../index.html" class="nav-btn"><i class="fa-solid fa-layer-group"></i> Gear</a>
                <div class="nav-btn active"><i class="fa-solid fa-box-archive"></i>Configs</div>
                <a href="../index.html" class="nav-btn"><i class="fa-solid fa-ghost"></i> hauntOS</a>
                <a href="../index.html" class="nav-btn"><i class="fa-solid fa-note-sticky"></i> Notes</a>
            </nav>
        </aside>

        <main class="main-content">
            <h2 style="color:#666; font-size: 14px; text-transform: uppercase; margin-bottom: 20px;">Configs</h2>
            <div id="mod-container" class="mod-grid">
                <p style="color:#666; font-size:12px;">Loading Database...</p>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        const USER_CONFIG = { discordId: "1182402282466332724" };
        const MODS_BIN_ID = "69842e50ae596e708f12918f"; 

        async function fetchMods() {
            const container = document.getElementById('mod-container');

            try {
                const res = await fetch(`https://api.jsonbin.io/v3/b/${MODS_BIN_ID}/latest`);
                const data = await res.json();
                
                // Matches your existing logic
                const mods = data.record.mods || [];
                container.innerHTML = ""; 

                if(mods.length === 0) {
                    container.innerHTML = '<p style="color:#444">No mods found.</p>';
                    return;
                }

                mods.forEach(mod => {
                    const card = document.createElement('div');
                    card.className = "mod-card";
                    
                    // -- MEDIA HANDLING --
                    let mediaHTML = "";
                    let mediaUrl = "";
                    let isVideo = false;

                    if(mod.media && mod.media.length > 0) {
                        const item = mod.media[0]; // Use first item as preview
                        mediaUrl = item.url;
                        isVideo = item.is_video;

                        if(isVideo) {
                            mediaHTML = `<video class="mod-video" src="${mediaUrl}" muted loop onmouseover="this.play()" onmouseout="this.pause()"></video>`;
                        } else {
                            mediaHTML = `<img class="mod-img" src="${mediaUrl}">`;
                        }
                    } else {
                        mediaUrl = "https://via.placeholder.com/200x140?text=No+Preview";
                        mediaHTML = `<img class="mod-img" src="${mediaUrl}">`;
                    }

                    // ADDED ONCLICK EVENT TO MOD-MEDIA DIV
                    card.innerHTML = `
                        <div class="mod-media" onclick="openLightbox('${mediaUrl}', ${isVideo})">
                            ${mediaHTML}
                        </div>
                        <div class="mod-content">
                            <div class="mod-type">${mod.type}</div>
                            <div class="mod-title">${mod.name}</div>
                            <div class="mod-date">Updated: ${mod.date}</div>
                        </div>
                        <div class="mod-actions">
                            <a href="${mod.downloadUrl}" target="_blank" class="mod-dl-btn">
                                <i class="fa-solid fa-download"></i> Download
                            </a>
                        </div>
                    `;
                    container.appendChild(card);
                });

            } catch(e) { console.error(e); container.innerHTML = '<p style="color:red">Error loading mods.</p>'; }
        }

        // --- LIGHTBOX FUNCTIONS ---
        function openLightbox(url, isVideo) {
            const box = document.getElementById('lightbox');
            const content = document.getElementById('lightbox-content');
            
            if(isVideo) {
                content.innerHTML = `<video id="lightbox-media" src="${url}" controls autoplay loop></video>`;
            } else {
                content.innerHTML = `<img id="lightbox-media" src="${url}">`;
            }

            box.classList.add('active');
        }

        function closeLightbox() {
            const box = document.getElementById('lightbox');
            box.classList.remove('active');
            
            // Clear content after delay to stop audio
            setTimeout(() => {
                document.getElementById('lightbox-content').innerHTML = '';
            }, 300);
        }
        
        // Close on Escape Key
        document.addEventListener('keydown', function(event) {
            if (event.key === "Escape") closeLightbox();
        });


        // --- LANYARD LOGIC ---
        async function updateStatus() {
            try {
                const res = await fetch(`https://api.lanyard.rest/v1/users/${USER_CONFIG.discordId}`);
                const data = await res.json();
                if(!data.success) return;
                const d = data.data;
                document.getElementById('sidebar-avatar').src = `https://cdn.discordapp.com/avatars/${d.discord_user.id}/${d.discord_user.avatar}.png`;
                document.getElementById('sidebar-displayname').innerText = d.discord_user.global_name || d.discord_user.username;
                document.getElementById('sidebar-username').innerText = "@" + d.discord_user.username;
            } catch(e) { console.log(e); }
        }

        particlesJS("particles-js", { "particles": { "number": { "value": 30 }, "color": { "value": "#ffffff" }, "opacity": { "value": 0.05 }, "size": { "value": 2 }, "line_linked": { "enable": true, "distance": 150, "color": "#ffffff", "opacity": 0.05 }, "move": { "enable": true, "speed": 0.5 } } });
        updateStatus();
        fetchMods();
    </script>
</body>
</html>
